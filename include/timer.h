#ifndef TIMER_H
#define TIMER_H

#include "types.h"
#include "description_tables.h"

#define TIMER_DATA_0_PORT 0x40
#define TIMER_DATA_1_PORT 0x41
#define TIMER_DATA_2_PORT 0x42
#define TIMER_COMMAND_PORT 0x43

// Select channel
#define TIMER_CHANNEL_0       0b00000000
#define TIMER_CHANNEL_1       0b01000000
#define TIMER_CHANNEL_2       0b10000000
#define TIMER_READ_BACK_LATCH 0b11000000

// Access mode
#define TIMER_BINARY_MODE       0b00000000
#define TIMER_BCD_MODE          0b00000001
#define TIMER_INTERRUPT_ON_TERMINAL_COUNT_MODE  0b00000000
#define TIMER_HARDWARE_RETRIGGERABLE_ONE_SHOT_MODE 0b00000010
#define TIMER_RATE_GENERATOR_MODE 0b00000100
#define TIMER_SQUARE_WAVE_GENERATOR_MODE 0b00000110
#define TIMER_SOFTWARE_STROBE_MODE 0b00001000
#define TIMER_HARDWARE_STROBE_MODE 0b00001010
#define TIMER_RATE_GENERATOR_MODE2 0b00001100
#define TIMER_SQUARE_WAVE_GENERATOR_MODE2 0b00001110

// BCD/Binary mode
#define TIMER_ACCESS_LATCH_COUNT 0b00000000
#define TIMER_ACCESS_LOW_BYTE   0b00000001

void timer_interrupt_handler(registers_t* regs);
void initialize_timer(uint32_t frequency);

#endif // TIMER_H